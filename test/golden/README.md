# Golden tests

This directory contains golden tests for the Silhouette template engine.
Golden tests compare the actual output of template rendering against
prepared expected output files, helping to
catch regressions and verify complex template behavior.

## Structure

- `inputs/` -
  Template files (`.sil`) with YAML frontmatter containing test data.
- `outputs/` -
  Expected output files generated by the template engine.

## Input file format

Input files use YAML frontmatter to define the context data,
followed by the template content:

```silhouette
---
name: "World"
greeting: "Hello"
age: 25
active: true
score: 3.14
---

{{ greeting }}, {{ name }}!
You are {{ age }} years old.
Active: {{ active }}
Score: {{ score }}
```

## Running tests

### Run all golden tests

```bash
dart test test/golden_test.dart
```

### Run a specific test

```bash
dart test test/golden_test.dart -p vm --plain-name 'Golden tests basic_variables'
```

### Update output files

When you want to regenerate the expected output files, run:

```bash
UPDATE_GOLDENS=true dart test test/golden_test.dart
```

This will overwrite the existing output files with
the new results from your input templates.

## Adding new golden tests

1. Create a new `.sil` file in the `inputs/` directory.
2. Add YAML frontmatter with your test data.
3. Write your template content below the frontmatter.
4. [Generate the new output files](#update-output-files).
5. Verify the output is correct, then commit both the input and output files.

## Debugging

If a golden test fails:

1. Check the error message for parsing or rendering issues.
2. Verify your YAML frontmatter syntax is valid.
3. Ensure property names don't conflict with reserved keywords.
4. Check that methods are called with the correct syntax.
5. If the changes are expected,
   [regenerate the output files](#update-output-files).
